{% schema %}
{
"name": "Banner 2",
"tag": "section",
"settings": [
{
"type": "header",
"content": "Desktop Media"
},
{
"type": "select",
"id": "desktop_media_type",
"label": "Desktop media type",
"options": [
{
"value": "image",
"label": "Image"
}, {
"value": "video",
"label": "Video"
}
],
"default": "image"
},
{
"type": "image_picker",
"id": "desktop_image",
"label": "Desktop image"
},
{
"type": "video",
"id": "desktop_video",
"label": "Desktop video"
},
{
"type": "image_picker",
"id": "desktop_video_poster",
"label": "Desktop video poster"
},
{
"type": "text",
"id": "desktop_height",
"label": "Desktop height",
"default": "100vh"
},
{
"type": "header",
"content": "Mobile Media"
},
{
"type": "select",
"id": "mobile_media_type",
"label": "Mobile media type",
"options": [
{
"value": "image",
"label": "Image"
}, {
"value": "video",
"label": "Video"
}
],
"default": "image"
},
{
"type": "image_picker",
"id": "mobile_image",
"label": "Mobile image"
},
{
"type": "video",
"id": "mobile_video",
"label": "Mobile video"
},
{
"type": "image_picker",
"id": "mobile_video_poster",
"label": "Mobile video poster"
},
{
"type": "text",
"id": "mobile_height",
"label": "Mobile height",
"default": "60vh"
},
{
"type": "header",
"content": "Video Settings"
},
{
"type": "checkbox",
"id": "autoplay_video",
"label": "Autoplay video",
"default": true
},
{
"type": "checkbox",
"id": "loop_video",
"label": "Loop video",
"default": true
},
{
"type": "checkbox",
"id": "mute_video",
"label": "Mute video",
"default": true
},
{
"type": "header",
"content": "Content"
},
{
"type": "checkbox",
"id": "show_card",
"label": "Show card"
},
{
"type": "text",
"id": "heading",
"label": "Heading",
"default": "Welcome to Our Store"
},
{
"type": "textarea",
"id": "subtext",
"label": "Subtext",
"default": "Discover the latest collections and exclusive offers."
},
{
"type": "url",
"id": "button_link",
"label": "Button link"
},
{
"type": "text",
"id": "button_text",
"label": "Button text",
"default": "Shop Now"
}
],
"presets": [
{
"name": "Banner 2"
}
]
}
{% endschema %}

{% if section.settings.button_link != blank %}
<a href="{{ section.settings.button_link }}">
  {% endif %}
  <section class="relative flex items-center justify-center w-full bg-gray-400 overflow-hidden 
  h-[var(--banner-height)] md:h-[var(--banner-height-desktop)]" style="
    --banner-height: {{ section.settings.mobile_height | default: '60vh' }};
    --banner-height-desktop: {{ section.settings.desktop_height | default: '100vh' }};
    ">

    <!-- Desktop Media -->
    <div class="hidden md:block absolute inset-0 w-full h-full">
      {% if section.settings.desktop_media_type == 'video' and section.settings.desktop_video != blank %}
      <video id="desktop-video" class="w-full h-full object-cover" {% if section.settings.autoplay_video %}autoplay{%
        endif %} {% if section.settings.loop_video %}loop{% endif %} {% if section.settings.mute_video %}muted{% endif
        %} playsinline webkit-playsinline preload="metadata" {% if section.settings.desktop_video_poster
        %}poster="{{ section.settings.desktop_video_poster | img_url: '1600x' }}" {% endif %}>
        <source src="{{ section.settings.desktop_video.sources[1].url }}" type="video/mp4">
        <source src="{{ section.settings.desktop_video.sources[0].url }}" type="video/webm">
      </video>
      {% elsif section.settings.desktop_media_type == 'image' and section.settings.desktop_image != blank %}
      <img src="{{ section.settings.desktop_image | img_url: '1600x' }}" alt="{{ section.settings.heading | escape }}"
        class="w-full h-full object-cover">
      {% endif %}
    </div>

    <!-- Mobile Media -->
    <div class="block md:hidden absolute inset-0 w-full h-full">
      {% if section.settings.mobile_media_type == 'video' and section.settings.mobile_video != blank %}
      <video id="mobile-video" class="w-full h-full object-cover" {% if section.settings.autoplay_video %}autoplay{%
        endif %} {% if section.settings.loop_video %}loop{% endif %} {% if section.settings.mute_video %}muted{% endif
        %} playsinline webkit-playsinline preload="metadata" {% if section.settings.mobile_video_poster
        %}poster="{{ section.settings.mobile_video_poster | img_url: '800x' }}" {% endif %}>
        <source src="{{ section.settings.mobile_video.sources[1].url }}" type="video/mp4">
        <source src="{{ section.settings.mobile_video.sources[0].url }}" type="video/webm">
      </video>
      {% elsif section.settings.mobile_media_type == 'image' and section.settings.mobile_image != blank %}
      <img src="{{ section.settings.mobile_image | img_url: '800x' }}" alt="{{ section.settings.heading | escape }}"
        class="w-full h-full object-cover">
      {% endif %}
    </div>

    {% if section.settings.show_card %}
    <div
      class="relative z-10 bg-white/70 rounded-xl p-6 md:p-10 flex flex-col items-center max-w-2xl mx-auto shadow-lg">
      <h1 class="text-2xl md:text-4xl font-bold text-gray-800 text-center">{{ section.settings.heading }}</h1>
      <p class="mt-2 md:mt-4 text-gray-700 text-base md:text-lg text-center">{{ section.settings.subtext }}</p>
      {% if section.settings.button_link != blank and section.settings.button_text != blank %}
      <a href="{{ section.settings.button_link }}"
        class="mt-5 px-6 py-3 rounded-md bg-gray-800 text-white font-semibold shadow hover:bg-gray-700 transition">
        {{ section.settings.button_text }}
      </a>
      {% endif %}
    </div>
    {% endif %}
  </section>
  {% if section.settings.button_link != blank %}
</a>
{% endif %}

{% if section.settings.autoplay_video %}
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const desktopVideo = document.getElementById('desktop-video');
    const mobileVideo = document.getElementById('mobile-video');

    function playVideo(video) {
      if (video) {
        console.log("Play video", video)
        const playPromise = video.play();
        if (playPromise !== undefined) {
          playPromise.catch((e) => {
            console.log("Play video failed", e)
            // Autoplay failed, try on user interaction
            document.addEventListener('touchstart', function () {
              video.play();
            }, { once: true });
          });
        }
      }
    }

    // Try to play videos
    playVideo(desktopVideo);
    playVideo(mobileVideo);

    // iOS specific handling
    if (/iPad|iPhone|iPod/.test(navigator.userAgent)) {
      [desktopVideo, mobileVideo].forEach(video => {
        if (video) {
          video.setAttribute('webkit-playsinline', '');
          video.load();
          setTimeout(() => playVideo(video), 100);
        }
      });
    }
  });
</script>
{% endif %}