{% comment %}
Product Recommendations Section
Usage: Add this section to product templates
{% endcomment %}

<section class="w-full">
  <div class="max-w-7xl mx-auto px-4 py-8">
    <h2 class="text-xl md:text-3xl font-bold text-center mb-8 uppercase">{{ section.settings.heading | default: 'You May Also Like' }}</h2>
  </div>

  <div class="product-gallery overflow-x-auto">
    <div class="flex gap-2 pb-4" style="width: max-content;">
      <!-- Try multiple fallback methods -->
      {% assign related_products = blank %}

      <!-- Method 1: From first collection -->
      {% if product.collections.size > 0 %}
      {% assign first_collection = product.collections.first %}
      {% assign related_products = first_collection.products | where: 'id', '!=', product.id | limit: section.settings.products_limit %}
      {% endif %}

      <!-- Method 2: If no collection products, get any products -->
      {% if related_products.size == 0 %}
      {% assign related_products = collections.all.products | where: 'id', '!=', product.id | limit: section.settings.products_limit %}
      {% endif %}

      <!-- Method 3: If still empty, get first products from shop -->
      {% if related_products.size == 0 %}
      {% assign related_products = collections.all.products | limit: section.settings.products_limit %}
      {% endif %}

      {% for related_product in related_products %}
      {% render 'product-card-carousel-2', product: related_product %}
      {% endfor %}
    </div>
  </div>
</section>

{% stylesheet %}
.product-gallery {
  scrollbar-width: none;
  scrollbar-color: #cbd5e0 transparent;
}
.product-gallery::-webkit-scrollbar {
  height: 6px;
}
.product-gallery::-webkit-scrollbar-track {
  background: transparent;
}
.product-gallery::-webkit-scrollbar-thumb {
  background-color: #cbd5e0;
  border-radius: 3px;
}
.product-gallery::-webkit-scrollbar-thumb:hover {
  background-color: #a0aec0;
}
{% endstylesheet %}

{% schema %}
{
"name": "Product Recommendations",
"settings": [
{
"type": "text",
"id": "heading",
"label": "Heading",
"default": "You May Also Like"
},
{
"type": "range",
"id": "products_limit",
"label": "Number of products",
"min": 4,
"max": 12,
"default": 8
}
],
"presets": [
{
"name": "Product Recommendations"
}
]
}
{% endschema %}