{% comment %}
  Filter Sidebar Component
  Usage: {% render 'filter-sidebar', collection: collection %}
{% endcomment %}

<aside id="filter-sidebar" class="hidden lg:block w-64 flex-shrink-0">
  <div class="bg-gray-50 rounded-lg p-6">
    <h3 class="text-lg font-semibold text-gray-900 mb-4">Sort & Filters</h3>

    <div class="sort-controls mb-6">
      <label for="sort-select" class="text-sm font-medium text-gray-700 mb-3">Sort by</label>
      <div class="text-sm">
        <select id="sort-select" class="rounded-md p-1 bg-transparent w-full border border-gray-200">
          <option value="manual">Featured</option>
          <option value="best-selling">Best Selling</option>
          <option value="title-ascending">A-Z</option>
          <option value="title-descending">Z-A</option>
          <option value="price-ascending">Price: Low to High</option>
          <option value="price-descending">Price: High to Low</option>
          <option value="created-ascending">Oldest First</option>
          <option value="created-descending">Newest First</option>
        </select>
      </div>
    </div>

    <!-- Price Filter -->
    <div class="filter-group mb-6">
      <h4 class="text-sm font-medium text-gray-700 mb-3">Price Range</h4>
      <div class="space-y-2">
        <label class="flex items-center">
          <input
            type="checkbox"
            class="price-filter mr-2"
            data-min="0"
            data-max="500">
          <span class="text-sm">Under ₹500</span>
        </label>
        <label class="flex items-center">
          <input
            type="checkbox"
            class="price-filter mr-2"
            data-min="500"
            data-max="1000">
          <span class="text-sm">₹500 - ₹1,000</span>
        </label>
        <label class="flex items-center">
          <input
            type="checkbox"
            class="price-filter mr-2"
            data-min="1000"
            data-max="2500">
          <span class="text-sm">₹1,000 - ₹2,500</span>
        </label>
        <label class="flex items-center">
          <input
            type="checkbox"
            class="price-filter mr-2"
            data-min="2500"
            data-max="5000">
          <span class="text-sm">₹2,500 - ₹5,000</span>
        </label>
        <label class="flex items-center">
          <input
            type="checkbox"
            class="price-filter mr-2"
            data-min="5000"
            data-max="999999">
          <span class="text-sm">Over ₹5,000</span>
        </label>
      </div>
    </div>

    <!-- Availability Filter -->
    <div class="filter-group mb-6">
      <h4 class="text-sm font-medium text-gray-700 mb-3">Availability</h4>
      <div class="space-y-2">
        <label class="flex items-center">
          <input
            type="checkbox"
            class="availability-filter mr-2"
            data-value="in-stock">
          <span class="text-sm">In Stock</span>
        </label>
        <label class="flex items-center">
          <input
            type="checkbox"
            class="availability-filter mr-2"
            data-value="out-of-stock">
          <span class="text-sm">Out of Stock</span>
        </label>
      </div>
    </div>

    <!-- Product Type Filter -->
    {% if collection.all_types.size > 0 %}
      <div class="filter-group mb-6">
        <h4 class="text-sm font-medium text-gray-700 mb-3">Product Type</h4>
        <div class="space-y-2">
          {% for product_type in collection.all_types %}
            {% if product_type != blank %}
              <label class="flex items-center">
                <input
                  type="checkbox"
                  class="type-filter mr-2"
                  data-value="{{ product_type | handleize }}">
                <span class="text-sm">{{ product_type }}</span>
              </label>
            {% endif %}
          {% endfor %}
        </div>
      </div>
    {% endif %}

    <!-- Vendor Filter -->
    {% if collection.all_vendors.size > 1 %}
      <div class="filter-group mb-6">
        <h4 class="text-sm font-medium text-gray-700 mb-3">Brand</h4>
        <div class="space-y-2">
          {% for vendor in collection.all_vendors %}
            <label class="flex items-center">
              <input
                type="checkbox"
                class="vendor-filter mr-2"
                data-value="{{ vendor | handleize }}">
              <span class="text-sm">{{ vendor }}</span>
            </label>
          {% endfor %}
        </div>
      </div>
    {% endif %}

    <!-- Clear Filters -->
    <button id="clear-filters" class="w-full bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300 transition-colors">
      Clear All Filters
    </button>
  </div>
</aside>

<script defer async>
  document.addEventListener('DOMContentLoaded', function() {
    const select = document.getElementById('sort-select');

    const selectedOption = new URL(location).searchParams.get('sort_by') || 'manual';
    select.value = selectedOption;
  })
</script>