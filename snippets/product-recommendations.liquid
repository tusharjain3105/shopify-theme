{% comment %}
  Product Recommendations Component
  Usage: {% render 'product-recommendations', product: product %}
{% endcomment %}

<div class="product-recommendations max-w-7xl mx-auto px-4">
  <h2 class="text-2xl font-bold text-center mb-8 uppercase">You May Also Like</h2>
  
  <!-- Use Shopify's product recommendations -->
  <div class="recommendations-container" data-product-id="{{ product.id }}">
    <div class="grid grid-cols-2 md:grid-cols-4 gap-6" id="recommendations-grid">
      <!-- Recommendations will be loaded here via AJAX -->
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const productId = {{ product.id }};
  const recommendationsContainer = document.getElementById('recommendations-grid');
  
  // Fetch product recommendations
  fetch(`/recommendations/products.json?product_id=${productId}&limit=4`)
    .then(response => response.json())
    .then(data => {
      if (data.products && data.products.length > 0) {
        let html = '';
        data.products.forEach(product => {
          const price = new Intl.NumberFormat('en-IN', {
            style: 'currency',
            currency: 'INR'
          }).format(product.price / 100);
          
          html += `
            <div class="recommendation-item">
              <a href="${product.url}" class="block group">
                <div class="aspect-[2/3] overflow-hidden bg-gray-50 mb-3">
                  <img 
                    src="${product.featured_image}" 
                    alt="${product.title}"
                    class="w-full aspect-[2/3] object-cover group-hover:scale-105 transition-transform duration-300"
                  />
                </div>
                <h3 class="text-sm font-medium text-gray-900 group-hover:text-gray-700 mb-1">
                  ${product.title}
                </h3>
                <p class="text-sm font-semibold text-gray-900">${price}</p>
              </a>
            </div>
          `;
        });
        recommendationsContainer.innerHTML = html;
      } else {
        // Fallback to related products from same collection
        document.querySelector('.product-recommendations').style.display = 'none';
      }
    })
    .catch(error => {
      console.log('Could not load product recommendations:', error);
    });
});
</script>
