{% comment %}
  AJAX template for search results
  This is rendered when the search is performed with ?view=ajax parameter
{% endcomment %}

{% if search.performed %}
  <div class="search-results-container">
    {% if search.results_count > 0 %}
      <div class="mb-8">
        <h2 class="text-2xl font-semibold mb-6 hidden">
          {{ search.results_count }} results for "{{ search.terms | escape }}"
        </h2>
        
        <!-- Products Grid -->
        <div id="products-container" class="products-grid grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
          {% for product in search.results %}
            {% if product.object_type == 'product' %}
              <div class="product-item">
                {% render 'product-card-enhanced', product: product %}
              </div>
            {% endif %}
          {% endfor %}
        </div>
      </div>

      <!-- Other Results (Articles, Pages) -->
      {% assign other_results = search.results | where: 'object_type', '!=' 'product' %}
      {% if other_results.size > 0 %}
        <div class="mt-12">
          <h2 class="text-2xl font-semibold mb-6">Other Results ({{ other_results.size }})</h2>
          <div class="space-y-6">
            {% for result in other_results %}
              <div class="p-6 bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow">
                <h3 class="text-xl font-medium text-gray-900 mb-2">
                  <a href="{{ result.url }}" class="hover:text-primary-600 transition-colors">
                    {{ result.title }}
                  </a>
                </h3>
                {% if result.object_type == 'article' %}
                  <p class="text-sm text-gray-500 mb-3">
                    {{ result.published_at | time_tag: format: 'date' }}
                    {% if result.tags.size > 0 %}
                      â€¢ {{ result.tags | join: ', ' }}
                    {% endif %}
                  </p>
                  {% if result.excerpt != blank %}
                    <p class="text-gray-600 mb-3">{{ result.excerpt | strip_html | truncatewords: 30 }}</p>
                  {% elsif result.content != blank %}
                    <p class="text-gray-600 mb-3">{{ result.content | strip_html | truncatewords: 30 }}</p>
                  {% endif %}
                {% endif %}
                <a href="{{ result.url }}" class="inline-flex items-center text-primary-600 hover:text-primary-800 font-medium">
                  Read more
                  <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                  </svg>
                </a>
              </div>
            {% endfor %}
          </div>
        </div>
      {% endif %}

    {% else %}
      <div class="text-center py-16">
        <svg class="w-16 h-16 text-gray-300 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
        <h2 class="text-2xl font-medium text-gray-700 mb-2">No results found</h2>
        <p class="text-gray-500 mb-6">We couldn't find any products matching "{{ search.terms | escape }}"</p>
        <a href="{{ routes.all_products_collection_url }}" class="inline-block bg-gray-900 text-white px-6 py-2 rounded-md hover:bg-gray-800 transition-colors">
          Browse All Products
        </a>
      </div>
    {% endif %}
  </div>

  <style>
    .product-card-enhanced {
      height: 100%;
      display: flex;
      flex-direction: column;
    }
    
    .product-card-enhanced a {
      display: flex;
      flex-direction: column;
      height: 100%;
    }
    
    .product-card-enhanced .product-info {
      padding: 1rem;
      flex-grow: 1;
      display: flex;
      flex-direction: column;
    }
    
    .product-title {
      font-weight: 500;
      margin-bottom: 0.5rem;
      color: #111827;
    }
    
    .price {
      margin-top: auto;
      font-weight: 600;
      color: #111827;
    }
    
    .price-compare {
      text-decoration: line-through;
      color: #6B7280;
      margin-left: 0.5rem;
    }
  </style>
{% endif %}
